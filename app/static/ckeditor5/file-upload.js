(()=>{var e={976:(e,t,r)=>{e.exports=r(672)("./src/clipboard.js")},968:(e,t,r)=>{e.exports=r(672)("./src/core.js")},684:(e,t,r)=>{e.exports=r(672)("./src/engine.js")},348:(e,t,r)=>{e.exports=r(672)("./src/ui.js")},748:(e,t,r)=>{e.exports=r(672)("./src/upload.js")},396:(e,t,r)=>{e.exports=r(672)("./src/widget.js")},672:e=>{"use strict";e.exports=CKEditor5.dll}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";r.r(o),r.d(o,{FileUpload:()=>m,SimpleFileUploadAdapter:()=>h});var e=r(968),t=r(748),n=r(348),i=r(976),s=r(684),a=r(396);let l={pdf:"pdf",doc:"msword",docx:"msword",xls:"vnd.ms-excel",xlsx:"vnd.openxmlformats-officedocument.spreadsheetml.sheet"};function d(e){return new Promise(((t,r)=>{const o=e.getAttribute("href");fetch(o).then((e=>e.blob())).then((e=>{const n=function(e,t){if(e.type)return e.type;if(t.match(/data:(image\/\w+);base64/))return t.match(/data:(image\/\w+);base64/)[1].toLowerCase();throw new Error("Could not retrieve mime type for file.")}(e,o),i=function(e,t,r){try{return new File([e],t,{type:r})}catch(e){return null}}(e,`file.${n.replace("file/","")}`,n);i?t(i):r()})).catch(r)}))}class c extends e.Command{refresh(){this.isEnabled=!0}execute(e){const r=this.editor,o=r.model,n=r.plugins.get(t.FileRepository);o.change((t=>{const r=e.file;for(const e of r)p(t,o,n,e)}))}}function p(e,t,r,o){const n=r.createLoader(o);n&&function(e,t,r={},o){const n=t.document.selection,i=(0,a.findOptimalInsertionRange)(n,t),s=e.createText(o.name,r);t.insertContent(s,i),s.parent&&e.setSelection(s,"on")}(e,t,{linkHref:"",uploadId:n.id},o)}class u extends e.Plugin{static get requires(){return[t.FileRepository,n.Notification,i.Clipboard]}static get pluginName(){return"FileUploadEditing"}constructor(e){super(e)}init(){const e=this.editor,r=e.model.document,o=e.model.schema,n=e.conversion,a=e.plugins.get(t.FileRepository),p=function(e){const t=Object.values(l).map((e=>e.replace("+","\\+")));return new RegExp(`^application\\/(${t.join("|")})$`)}(e.config.get("simpleFileUpload.fileTypes"));o.extend("$text",{allowAttributes:["uploadId","uploadStatus"]}),e.commands.add("fileUpload",new c(e)),n.for("upcast").attributeToAttribute({view:{name:"a",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",((t,r)=>{if(o=r.dataTransfer,Array.from(o.types).includes("text/html")&&""!==o.getData("text/html"))return;var o;const n=Array.from(r.dataTransfer.files).filter((e=>!!e&&p.test(e.type))),i=r.targetRanges.map((t=>e.editing.mapper.toModelRange(t)));e.model.change((r=>{r.setSelection(i),n.length&&(t.stop(),e.model.enqueueChange("default",(()=>{e.execute("fileUpload",{file:n})})))}))})),this.listenTo(e.plugins.get(i.Clipboard),"inputTransformation",((t,r)=>{const o=Array.from(e.editing.view.createRangeIn(r.content)).filter((e=>{return!(!(t=e.item).is("element","a")||!t.getAttribute("href"))&&t.getAttribute("href")&&!e.item.getAttribute("uploadProcessed");var t})).map((e=>({promise:d(e.item),fileElement:e.item})));if(!o.length)return;const n=new s.UpcastWriter;for(const e of o){n.setAttribute("uploadProcessed",!0,e.fileElement);const t=a.createLoader(e.promise);t&&(n.setAttribute("href","",e.fileElement),n.setAttribute("uploadId",t.id,e.fileElement))}})),e.editing.view.document.on("dragover",((e,t)=>{t.preventDefault()})),r.on("change",(()=>{const t=r.differ.getChanges({includeChangesInGraveyard:!0});for(const r of t)if("insert"==r.type){const t=r.position.nodeAfter;if(t){const o="$graveyard"==r.position.root.rootName;for(const r of g(e,t)){const e=r.getAttribute("uploadId");if(!e)continue;const t=a.loaders.get(e);t&&(o?t.abort():"idle"==t.status&&this._readAndUpload(t,r))}}}}))}_readAndUpload(e,r){const o=this.editor,i=o.model,s=o.locale.t,a=o.plugins.get(t.FileRepository),l=o.plugins.get(n.Notification);return i.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","reading",r)})),e.read().then((()=>{const t=e.upload();return i.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","uploading",r)})),t})).then((e=>{i.enqueueChange("transparent",(t=>{t.setAttributes({uploadStatus:"complete",linkHref:e.resourceUrl},r)})),d()})).catch((t=>{if("error"!==e.status&&"aborted"!==e.status)throw t;"error"==e.status&&t&&l.showWarning(t,{title:s("Upload failed"),namespace:"upload"}),d(),i.enqueueChange("transparent",(e=>{e.remove(r)}))}));function d(){i.enqueueChange("transparent",(e=>{e.removeAttribute("uploadId",r),e.removeAttribute("uploadStatus",r)})),a.destroyLoader(e)}}}function g(e,t){return Array.from(e.model.createRangeOn(t)).filter((e=>e.item.hasAttribute("linkHref"))).map((e=>e.item))}class f extends e.Plugin{init(){const e=this.editor,r=e.t;e.ui.componentFactory.add("fileUpload",(o=>{const n=new t.FileDialogButtonView(o),i=e.commands.get("fileUpload"),s=e.config.get("simpleFileUpload.fileTypes");return n.set({acceptedType:s.map((e=>`${e}`)).join(","),allowMultipleFiles:!1}),n.buttonView.set({label:r("Insert file"),icon:'<?xml version="1.0" encoding="utf-8"?>\r\n\x3c!-- Svg Vector Icons : http://www.onlinewebfonts.com/icon --\x3e\r\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\r\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">\r\n<metadata> Svg Vector Icons : http://www.onlinewebfonts.com/icon </metadata>\r\n<g><g transform="translate(0.000000,511.000000) scale(0.100000,-0.100000)"><path d="M1443.6,4990.4c-26.9-11.5-69.2-38.4-92.2-61.5c-107.6-99.9-99.9,232.5-99.9-4823.9v-4677.8l42.3-63.4c25-34.6,69.2-82.6,98-103.8c53.8-40.3,57.7-40.3,1966.1-40.3h1910.3l51.9,53.8c51.9,50,53.8,59.6,53.8,246v194.1l-63.4,55.7l-61.5,55.7H3557.7H1866.4V110.8v4285.8H3894h2027.6v-945.6c0-622.7,7.7-974.4,21.2-1024.3c11.5-42.3,44.2-101.9,71.1-132.6c101.9-107.6,92.2-107.6,1147.4-107.6h970.5V716.1c0-1633.6-5.8-1560.6,124.9-1616.3c84.6-34.6,280.6-34.6,363.2,0c136.4,55.7,126.8-67.3,126.8,1795c0,1620.1-1.9,1679.7-36.5,1748.9c-55.7,105.7-2262,2300.5-2350.4,2338.9c-63.4,25-351.7,28.8-2469.6,26.9C2345,5009.6,1474.4,5001.9,1443.6,4990.4z M7132.3,3368.3l567-567h-572.7h-570.8v567c0,311.3,1.9,567,5.8,567C6563.4,3935.3,6821,3679.6,7132.3,3368.3z"/><path d="M6242.5-1670.8c-411.3-411.3-772.6-784.1-803.3-830.2c-157.6-242.1,55.7-536.2,334.4-463.2c69.2,19.2,144.1,86.5,522.7,463.2c244.1,242.2,449.7,440.1,457.4,440.1c5.8,0,15.4-572.7,17.3-1272.3c5.8-1239.6,7.7-1276.1,44.2-1326.1c48-67.3,174.9-130.7,257.5-130.7c90.3,0,203.7,65.4,253.7,148l46.1,73l5.8,1256.9l5.8,1258.8l445.9-443.9c388.2-388.2,457.4-447.8,532.4-467c251.8-67.3,468.9,192.2,355.5,430.5c-15.4,32.7-376.7,407.4-803.3,834.1C7157.3-944.4,7140-927.1,7065-927.1S6972.8-944.4,6242.5-1670.8z"/></g></g>\r\n</svg>',tooltip:!0}),n.buttonView.bind("isEnabled").to(i),n.on("done",((t,r)=>{const o=r;o.length&&e.execute("fileUpload",{file:o})})),n}))}}class m extends e.Plugin{static get requires(){return[u,f]}static get pluginName(){return"fileUpload"}}class h extends e.Plugin{static get requires(){return[t.FileRepository]}static get pluginName(){return"SimpleFileUploadAdapter"}init(){const e=this.editor.config.get("simpleFileUpload");e&&(e.url?this.editor.plugins.get(t.FileRepository).createUploadAdapter=t=>new w(t,e):console.warn('simple-upload-adapter-missing-uploadUrl: Missing the "uploadUrl" property in the "simpleUpload" editor configuration.'))}}class w{constructor(e,t){this.loader=e,this.options=t}upload(){return this.loader.file.then((e=>new Promise(((t,r)=>{this._initRequest(),this._initListeners(t,r,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.options.url,!0),e.responseType="json"}_initListeners(e,t,r){const o=this.xhr,n=this.loader,i=`Couldn't upload file: ${r.name}.`;o.addEventListener("error",(()=>t(i))),o.addEventListener("abort",(()=>t())),o.addEventListener("load",(()=>{const r=o.response;if(!r||r.error)return t(r&&r.error?r.error.message:i);e({resourceUrl:r.url,default:r.url})})),o.upload&&o.upload.addEventListener("progress",(e=>{e.lengthComputable&&(n.uploadTotal=e.total,n.uploaded=e.loaded)}))}_sendRequest(e){const t=this.options.headers||{},r=this.options.withCredentials||!1;for(const e of Object.keys(t))this.xhr.setRequestHeader(e,t[e]);this.xhr.withCredentials=r;const o=new FormData;o.append("upload",e),this.xhr.send(o)}}})(),(window.CKEditor5=window.CKEditor5||{}).fileUpload=o})();